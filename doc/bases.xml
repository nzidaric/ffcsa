<Chapter Label="ch:CS"><Heading>Constructions and representations</Heading>
<Section Label="XMLplainsearch"><Heading>Searching for polynomials and elements</Heading>

<#Include Label="FindPoly">
<#Include Label="IsNormalFFE">
<#Include Label="FindNormalFFEs">


</Section>
<Section Label="XMLbases"><Heading>Generating different bases</Heading>

As explained in Section <Ref Sect="XMLmatrix"/>, we adopt the notion of
basis <E>direction</E> from the hardware perspective. Direction applies
to polynomial bases and their dual bases. All methods that generate bases
compute the set <A>S</A> and tie it to the field as <C>Basis(F,S)</C>.
(<Ref Oper="Basis" BookName="ref"/>).

<#Include Label="GeneratePB">
<#Include Label="IsDualBasisPair">


<Subsection Label="NBDBdef">
  <Heading>Finding a dual basis to normal basis</Heading>
<Cite Key="menezesFF"  Where="(4.7)" />
Let <M>NB=\{\alpha,\alpha^q,\alpha^{q^2},\dots, \alpha^{q^{m-1}}\}</M>
be a normal basis of <M>{\mathbb F}_{q^m}/{\mathbb F}_q</M>.  Let
<Display> t_i ={\rm Tr}^{{\mathbb F}_{q^m}}_{{\mathbb F}_q}(\alpha\alpha^{q^i})
   \qquad  {\rm and}\qquad N(x)=\sum_{i=0}^{m-1}t_ix^i. </Display>
Furthermore, let
<Display>  D(x)= \sum_{i=0}^{m-1}d_ix^i, \quad d_i\in {\mathbb F}_q,</Display>
be the unique polynomial such that
<M>   N(x)D(x)\equiv 1\,{\rm mod}\, (x^m+1)</M>.
Then, the dual basis is generated by
<M>  \beta=\sum_{i=0}^{m-1}d_i\alpha^{q^i}</M>, obtained from coefficients
of <M>D(x)</M>.

Conjugates of element <M>\beta</M> generate a basis <M>DB</M>,
which is dual w.r.t. <M>NB</M> and is itself a normal basis:
<M>DB = \{\beta,\beta^q,\beta^{q^2},\dots, \beta^{q^{m-1}}\}</M>.
</Subsection>

<#Include Label="GeneratorOfDBtoNB">
<!--

-->


<Subsection Label="PBDBdef">
  <Heading>Finding a dual basis to polynomial basis</Heading>

<Cite Key="AHnotes"  Where="(12)" /> and <Cite Key="mullen"  Where="(5.1.12)" />
Let  <M>\alpha</M> be a root of a monic irreducible polynomial <M>f</M> of
degree <M>m</M> over  <M>{\mathbb F}_q</M>, and let
<M>PB = \{1,\alpha,\alpha^2,\dots\alpha^{m-1}\}</M>
be the corresponding polynomial basis of <M>{\mathbb F}_{q^m}/{\mathbb F}_q</M>.
<!-- % dont wanna use the word splitting !!!coz then i have to say what a splitting field is-->
The polynomial <M>f</M> can be rewritten as:
<Display>
f(x)= (x-\alpha)(\sum_{i=0}^{m-1}g_ix^i) \quad
{\rm where} \quad g_i\in{\mathbb F}_{q^m} \quad {\rm for} \quad i=0,\dots,m-1.
</Display>

The dual basis of <M>PB</M> is obtained from coefficients <M>g_i</M>
and the derivative of <M>f(x)</M> evaluated for <M>\alpha</M>,
that is <M>f'(\alpha)</M>:
<Display>
DB = \{ \frac{g_0}{f'(\alpha)}, \dots, \frac{g_{m-1}}{f'(\alpha)}\}
</Display>
</Subsection>

<#Include Label="GenerateDBtoPB">

</Section>


<Section Label="PBDBdef">
  <Heading>Tower field constructions</Heading>
For a composite integer <M>m=n_1\cdots n_k</M>, where
<M>n_i, \, i=1,\dots, k</M> are positive integers (not necessarily primes),
it is possible to build <M>{\mathbb F}_{p^m}</M> as a tower of extensions
  <M>{\mathbb F}_{\left(\dots ((p^{{n_1}})^{n_2})\dots\right)^{n_k}}</M>
over its prime subfield <M>{\mathbb F}_p</M>. Instead of constructing
<M>{\mathbb F}_{p^m}</M> as a single extension of degree
<M>[{\mathbb F}_{p^m}:{\mathbb F}_p]=m</M> over the prime field,
the field is constructed in <M>k</M> steps, building an extension
<M>\mathcal{K}_i/\mathcal{K}_{i-1}</M> of degree
<M>[\mathcal{K}_i:\mathcal{K}_{i-1}]=n_i</M> at step <M>i</M>,
where <M>n_i</M> is a factor in decomposition of <M>m</M>,
starting with <M>\mathcal{K}_0={\mathbb F}_p</M>:
<Display>
{\mathbb F}_p=\mathcal{K}_0\subset \mathcal{K}_1\subset \dots\subset \mathcal{K}_{k-1}
\subset \mathcal{K}_k={\mathbb F}_{\left(\dots ((p^{{n_1}})^{n_2})\dots\right)^{n_k}}
\cong {\mathbb F}_{p^m}
</Display>
with their corresponding orders
<Display>
p\leq p^{n_1}\leq p^{n_1\cdot n_2}\leq \dots \leq p^{n_1\cdots
 n_k} = p^m , {\rm where\; } m=n_1\cdots n_k
</Display>
Note that  the field obtained with each extension is
 isomorphic to a field whose order is <M>p</M> to the power of  partial
  product of extension degrees up to the current extension, for example
<M>{\mathbb F}_{(p^{n_1})^{n_2}}\cong {\mathbb F}_{p^{n_1\cdot n_2}}</M>.




For the generalized methods for generating tower field bases to arbitrary degree
 of extension and different bases, e.g., a mix of polynomial and normal bases,
 a distinction is made between <E>reference field</E> defining polynomials (RDP)
 and <E>extension field</E> defining polynomial (EDP).
 This distinction is explained with the example
 <M>{\mathbb F}_2 \subset {\mathbb F}_{2^2}\subset {\mathbb F}_{(2^2)^2}
 \subset {\mathbb F}_{((2^2)^2)^2} \cong {\mathbb F}_{2^8}</M>, shown in figure:

<Alt Only="LaTeX">\begin{figure}[b!]\centering\includegraphics{tower1}
  \caption{Finite field <M>{\mathbb F}_{((2^2)^2)^2}</M> - tower construction}\end{figure}</Alt>
<Alt Only="HTML">&lt;img src="fsr.jpg" align="center" /></Alt>
<Alt Only="Text">/See diagrams in HTML and PDF versions of the manual/</Alt>
<P/>
<List>
  <Item>
<E>The reference field</E> defining polynomials are labelled
<M>p_1, p_2, p_3</M>. They are the defining polynomials of the isomorphic
reference finite fields. For example, <M>p_3</M> is a degree 8 defining
polynomial of the finite field <M>{\mathbb F}_{2^8}</M>,
which is isomorphic to  <M>{\mathbb F}_{((2^2)^2)^2}</M>.
  </Item>
  <Item>
<E>The extension field</E> defining polynomials are labelled
<M>f_1, f_2, f_3</M>, and can be seen on the outer left side of the diagram.
For example, the degree 2 polynomial <M>f_3</M> is irreducible over
<M>{\mathbb F}_{(2^2)^2}</M>  and used to construct
<M>{\mathbb F}_{((2^2)^2)^2}/{\mathbb F}_{(2^2)^2}</M>
 as <M>{\mathbb F}_{(2^2)^2}[x]/(f_3)</M>.
  </Item>
</List>
With each new extension <M>{\mathbb F}_{q^2}/{\mathbb F}_q</M>, a
<E>per-level</E> basis (PLB) can be found (or <E>extension basis</E> (EB) for
easier reference to EDP). For this example, a polynomial
basis with the root of the EDP <M>f_i</M> is used for each level:
<List>
<Item> <M>B_{{\mathbb F}_{((2^2)^2)^2}/{\mathbb F}_{(2^2)^2}}=\{1,\nu\}</M>,
        where <M>f_3(\nu)=0</M></Item>
<Item> <M>B_{{\mathbb F}_{(2^2)^2}/{\mathbb F}_{2^2}}=\{1,\mu\}</M>,
        where <M>f_2(\mu)=0</M></Item>
<Item> <M>B_{{\mathbb F}_{2^2}/{\mathbb F}_2}=\{1,\lambda\}</M>,
        where <M>f_1(\lambda)=0</M></Item>
</List>

An element  <M>{\mathbb F}_{((2^2)^2)^2}</M> is represented w.r.t. the per-level
basis <M>B_{{\mathbb F}_{((2^2)^2)^2}/{\mathbb F}_{(2^2)^2}}</M>
as <M>A=a_0 +a_1\nu</M>, where <M>a_0,a_1\in{\mathbb F}_{(2^2)^2}</M>.
Both coordinates <M>a_0,a_1</M> are then represented w.r.t. the per-level basis
<M>B_{{\mathbb F}_{(2^2)^2}/{\mathbb F}_{2^2}}</M> as
<M>a_i=a_{i0} +a_{i1}\mu</M>,
where <M>a_{i0},a_{i1}\in{\mathbb F}_{2^2}</M>, and so on. The PLBs lead to the
 construction of a tower field basis (TFB) of the isomorphic field
 <M>{{\mathbb F}_{2^8}/{\mathbb F}_2}</M>
 obtained as products of PLB elements:

<Display>
TFB_{{\mathbb F}_{2^8}/{\mathbb F}_2}=\{t_0, t_1, \dots , t_7\}
=\{1, \lambda, \mu, \mu\lambda,\nu, \nu\lambda, \nu\mu, \nu\mu\lambda\}
</Display>

The per-level bases are used for submodule extraction and generation.
When needed, the TFB is used for transition matrices between the tower field
construction and the isomorphic field, construced with a single extension, e.g.,
between  <M>{\mathbb F}_{((2^2)^2)^2}</M> and <M>{\mathbb F}_{2^8}</M>.
TFB is also used to generate the testvectors for the top-level hardware modules.


<#Include Label="GenerateTFBfromEBlist">
<#Include Label="FindEDPLAllfromEDL">
</Section>

</Chapter>
